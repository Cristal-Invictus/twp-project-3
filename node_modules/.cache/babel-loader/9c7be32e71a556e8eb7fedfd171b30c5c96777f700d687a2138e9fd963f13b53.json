{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { defineStore } from 'pinia';\nimport categoryService from '../services/categoryService.js';\nimport postService from '../services/postService.js';\nexport const useCategoryStore = defineStore('categoryStore', {\n  state: () => ({\n    categories: []\n  }),\n  actions: {\n    async loadCategories() {\n      const response = await categoryService.getAll();\n      if (response.success) {\n        // Une seule requ√™te pour tous les posts\n        const tasksResponse = await postService.getAll();\n        if (tasksResponse.success) {\n          const categoriesWithTasks = response.data.map(cat => {\n            const tasks = tasksResponse.data.filter(post => post.categories && post.categories.includes(cat.id));\n            console.log(`üè™ Store: Cat√©gorie \"${cat.name}\" (ID: ${cat.id}) a ${tasks.length} posts`);\n            return {\n              ...cat,\n              title: cat.name || '',\n              // WordPress utilise 'name', on le mappe vers 'title' pour l'app\n              tasks: tasks\n            };\n          });\n          this.categories = categoriesWithTasks;\n          console.log('üè™ Store: Cat√©gories charg√©es avec succ√®s:', this.categories.length);\n        } else {\n          console.error('üè™ Store: Erreur lors du chargement des posts:', tasksResponse.error);\n          // Charger les cat√©gories sans posts en cas d'erreur\n          this.categories = response.data.map(cat => ({\n            ...cat,\n            title: cat.name || '',\n            tasks: []\n          }));\n        }\n      } else {\n        console.error('üè™ Store: Erreur lors du chargement des cat√©gories:', response.error);\n      }\n    },\n    async addCategory(category) {\n      const response = await categoryService.create(category);\n      if (response.success) {\n        const cat = response.data;\n        this.categories.push({\n          ...cat,\n          title: cat.title || cat.name || '',\n          tasks: []\n        });\n      }\n    },\n    async updateCategory(category) {\n      console.log(`üè™ Store: Tentative de mise √† jour cat√©gorie:`, category);\n      console.log(`üè™ Store: Cat√©gories avant mise √† jour:`, this.categories.length);\n      const response = await categoryService.update(category.id, category);\n      console.log(`üè™ Store: R√©ponse du service:`, response);\n      if (response.success) {\n        const idx = this.categories.findIndex(c => c.id === category.id);\n        console.log(`üè™ Store: Index trouv√© pour la cat√©gorie:`, idx);\n        if (idx !== -1) {\n          const oldCategory = this.categories[idx];\n          this.categories[idx] = response.data;\n          console.log(`üè™ Store: Cat√©gorie mise √† jour - Ancien:`, oldCategory);\n          console.log(`üè™ Store: Cat√©gorie mise √† jour - Nouveau:`, response.data);\n        } else {\n          console.warn(`üè™ Store: Cat√©gorie avec ID ${category.id} non trouv√©e dans le store`);\n        }\n      } else {\n        console.error(`üè™ Store: √âchec de la mise √† jour:`, response.error);\n      }\n      return response;\n    },\n    async deleteCategory(id) {\n      console.log(`üè™ Store: Tentative de suppression de la cat√©gorie ID: ${id}`);\n      console.log(`üè™ Store: Cat√©gories avant suppression:`, this.categories.length);\n      const response = await categoryService.delete(id);\n      console.log(`üè™ Store: R√©ponse du service:`, response);\n      if (response.success) {\n        const oldCount = this.categories.length;\n        this.categories = this.categories.filter(c => c.id !== id);\n        console.log(`üè™ Store: Cat√©gories apr√®s suppression: ${this.categories.length} (√©tait ${oldCount})`);\n        console.log(`üè™ Store: Suppression r√©ussie dans le store`);\n      } else {\n        console.error(`üè™ Store: √âchec de la suppression:`, response.error);\n      }\n      return response;\n    }\n  },\n  persist: true\n});","map":{"version":3,"names":["defineStore","categoryService","postService","useCategoryStore","state","categories","actions","loadCategories","response","getAll","success","tasksResponse","categoriesWithTasks","data","map","cat","tasks","filter","post","includes","id","console","log","name","length","title","error","addCategory","category","create","push","updateCategory","update","idx","findIndex","c","oldCategory","warn","deleteCategory","delete","oldCount","persist"],"sources":["/Users/akoyessoucristal/Rendu/C-DEV-121-COT-1-1-twp-cristal.akoyessou/src/store/categoryStore.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport categoryService from '../services/categoryService.js';\nimport postService from '../services/postService.js';\n\nexport const useCategoryStore = defineStore('categoryStore', {\n  state: () => ({\n    categories: [],\n  }),\n  actions: {\n    async loadCategories() {\n      \n      const response = await categoryService.getAll();\n      if (response.success) {\n        \n        \n        // Une seule requ√™te pour tous les posts\n        const tasksResponse = await postService.getAll();\n        \n        \n        if (tasksResponse.success) {\n          const categoriesWithTasks = response.data.map(cat => {\n            const tasks = tasksResponse.data.filter(post => \n              post.categories && post.categories.includes(cat.id)\n            );\n            console.log(`üè™ Store: Cat√©gorie \"${cat.name}\" (ID: ${cat.id}) a ${tasks.length} posts`);\n            \n            return {\n              ...cat,\n              title: cat.name || '', // WordPress utilise 'name', on le mappe vers 'title' pour l'app\n              tasks: tasks,\n            };\n          });\n          \n          this.categories = categoriesWithTasks;\n          console.log('üè™ Store: Cat√©gories charg√©es avec succ√®s:', this.categories.length);\n        } else {\n          console.error('üè™ Store: Erreur lors du chargement des posts:', tasksResponse.error);\n          // Charger les cat√©gories sans posts en cas d'erreur\n          this.categories = response.data.map(cat => ({\n            ...cat,\n            title: cat.name || '',\n            tasks: [],\n          }));\n        }\n      } else {\n        console.error('üè™ Store: Erreur lors du chargement des cat√©gories:', response.error);\n      }\n    },\n    async addCategory(category) {\n      const response = await categoryService.create(category);\n      if (response.success) {\n        const cat = response.data;\n        this.categories.push({\n          ...cat,\n          title: cat.title || cat.name || '',\n          tasks: [],\n        });\n      }\n    },\n    async updateCategory(category) {\n      console.log(`üè™ Store: Tentative de mise √† jour cat√©gorie:`, category);\n      console.log(`üè™ Store: Cat√©gories avant mise √† jour:`, this.categories.length);\n      \n      const response = await categoryService.update(category.id, category);\n      \n      console.log(`üè™ Store: R√©ponse du service:`, response);\n      \n      if (response.success) {\n        const idx = this.categories.findIndex(c => c.id === category.id);\n        console.log(`üè™ Store: Index trouv√© pour la cat√©gorie:`, idx);\n        \n        if (idx !== -1) {\n          const oldCategory = this.categories[idx];\n          this.categories[idx] = response.data;\n          console.log(`üè™ Store: Cat√©gorie mise √† jour - Ancien:`, oldCategory);\n          console.log(`üè™ Store: Cat√©gorie mise √† jour - Nouveau:`, response.data);\n        } else {\n          console.warn(`üè™ Store: Cat√©gorie avec ID ${category.id} non trouv√©e dans le store`);\n        }\n      } else {\n        console.error(`üè™ Store: √âchec de la mise √† jour:`, response.error);\n      }\n      \n      return response;\n    },\n    async deleteCategory(id) {\n      console.log(`üè™ Store: Tentative de suppression de la cat√©gorie ID: ${id}`);\n      console.log(`üè™ Store: Cat√©gories avant suppression:`, this.categories.length);\n      \n      const response = await categoryService.delete(id);\n      \n      console.log(`üè™ Store: R√©ponse du service:`, response);\n      \n      if (response.success) {\n        const oldCount = this.categories.length;\n        this.categories = this.categories.filter(c => c.id !== id);\n        console.log(`üè™ Store: Cat√©gories apr√®s suppression: ${this.categories.length} (√©tait ${oldCount})`);\n        console.log(`üè™ Store: Suppression r√©ussie dans le store`);\n      } else {\n        console.error(`üè™ Store: √âchec de la suppression:`, response.error);\n      }\n      \n      return response;\n    },\n  },\n  persist: true,\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}